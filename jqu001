this code is update by jqu001